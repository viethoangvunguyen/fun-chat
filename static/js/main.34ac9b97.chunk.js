(this.webpackJsonpsrc=this.webpackJsonpsrc||[]).push([[0],{166:function(e,t,n){},167:function(e,t,n){},249:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(44),i=n.n(r),o=(n(166),n(167),n(47)),s=n(29),l=n.n(s),d=n(257),u=n(253),j=n(254),b=n(74),h=n(90);n(250),n(169),n(251);h.a.initializeApp({apiKey:"AIzaSyByQG1Xo3xKKClHI7ufck42QgkAjc-w-bs",authDomain:"fun-chat-a3e83.firebaseapp.com",projectId:"fun-chat-a3e83",storageBucket:"fun-chat-a3e83.appspot.com",messagingSenderId:"858771405295",appId:"1:858771405295:web:c2c817f0f6eb357cf6de1a",measurementId:"G-751NYG5RYN"}),h.a.analytics();var p=h.a.auth(),m=h.a.firestore();window.location.hostname;var f=h.a,O=n(8),x=n(3),v=function(e,t){m.collection(e).add(Object(x.a)(Object(x.a)({},t),{},{createdAt:f.firestore.FieldValue.serverTimestamp()}))},g=function(e){for(var t=e.split(" ").filter((function(e){return e})),n=t.length,a=[],c=[],r=[],i=0;i<n;i++)a[i]=!1;!function e(i){for(var o=0;o<n;o++)a[o]||(a[o]=!0,c[i]=t[o],i===n-1&&r.push(c.join(" ")),e(i+1),a[o]=!1)}(0);var o=r.reduce((function(e,t){var n=function(e){var t=[],n="";return e.split("").forEach((function(e){n+=e,t.push(n)})),t}(t);return[].concat(Object(O.a)(e),Object(O.a)(n))}),[]);return o},y=n(7),C=d.a.Title,w=new f.auth.FacebookAuthProvider,I=new f.auth.GoogleAuthProvider;function N(){var e=function(){var e=Object(o.a)(l.a.mark((function e(t){var n,a,c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.signInWithPopup(t);case 2:n=e.sent,a=n.additionalUserInfo,c=n.user,null!==a&&void 0!==a&&a.isNewUser&&v("users",{displayName:c.displayName,email:c.email,photoURL:c.photoURL,uid:c.uid,providerId:a.providerId,keywords:g(null===(r=c.displayName)||void 0===r?void 0:r.toLowerCase())});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(y.jsx)("div",{children:Object(y.jsx)(u.a,{justify:"center",style:{height:800},children:Object(y.jsxs)(j.a,{span:8,children:[Object(y.jsx)(C,{style:{textAlign:"center"},level:3,children:"Fun Chat"}),Object(y.jsx)(b.a,{style:{width:"100%",marginBottom:5},onClick:function(){return e(I)},children:"\u0110\u0103ng nh\u1eadp b\u1eb1ng Google"}),Object(y.jsx)(b.a,{style:{width:"100%"},onClick:function(){return e(w)},children:"\u0110\u0103ng nh\u1eadp b\u1eb1ng Facebook"})]})})})}var R=n(129),A=n(31),k=n(42),U=n(261),L=n(43),S=n(5),F=n(255),V=c.a.createContext();function T(e){var t=e.children,n=Object(a.useState)({}),r=Object(S.a)(n,2),i=r[0],o=r[1],s=Object(A.f)(),l=Object(a.useState)(!0),d=Object(S.a)(l,2),u=d[0],j=d[1];return c.a.useEffect((function(){var e=p.onAuthStateChanged((function(e){if(e){var t=e.displayName,n=e.email,a=e.uid,c=e.photoURL;return o({displayName:t,email:n,uid:a,photoURL:c}),j(!1),void s.push("/")}o({}),j(!1),s.push("/login")}));return function(){e()}}),[s]),Object(y.jsx)(V.Provider,{value:{user:i},children:u?Object(y.jsx)(F.a,{style:{position:"fixed",inset:0}}):t})}var M,_=function(e,t){var n=Object(a.useState)([]),r=Object(S.a)(n,2),i=r[0],o=r[1];return c.a.useEffect((function(){var n=m.collection(e).orderBy("createdAt");if(t){if(!t.compareValue||!t.compareValue.length)return void o([]);n=n.where(t.fieldName,t.operator,t.compareValue)}var a=n.onSnapshot((function(e){var t=e.docs.map((function(e){return Object(x.a)(Object(x.a)({},e.data()),{},{id:e.id})}));o(t)}));return a}),[e,t]),i},P=c.a.createContext();function z(e){var t=e.children,n=Object(a.useState)(!1),r=Object(S.a)(n,2),i=r[0],o=r[1],s=Object(a.useState)(!1),l=Object(S.a)(s,2),d=l[0],u=l[1],j=Object(a.useState)(""),b=Object(S.a)(j,2),h=b[0],p=b[1],m=c.a.useContext(V).user.uid,f=c.a.useMemo((function(){return{fieldName:"members",operator:"array-contains",compareValue:m}}),[m]),O=_("rooms",f),x=c.a.useMemo((function(){return O.find((function(e){return e.id===h}))||{}}),[O,h]),v=c.a.useMemo((function(){return{fieldName:"uid",operator:"in",compareValue:x.members}}),[x.members]),g=_("users",v);return Object(y.jsx)(P.Provider,{value:{rooms:O,members:g,selectedRoom:x,isAddRoomVisible:i,setIsAddRoomVisible:o,selectedRoomId:h,setSelectedRoomId:p,isInviteMemberVisible:d,setIsInviteMemberVisible:u,clearState:function(){p(""),o(!1),u(!1)}},children:t})}var B=L.a.div(M||(M=Object(k.a)(["\n  display: flex;\n  justify-content: space-between;\n  padding: 12px 16px;\n  border-bottom: 1px solid rgba(82, 38, 83);\n\n  .username {\n    color: white;\n    margin-left: 5px;\n  }\n"])));function E(){var e,t=c.a.useContext(V).user,n=t.displayName,a=t.photoURL,r=c.a.useContext(P).clearState;return Object(y.jsxs)(B,{children:[Object(y.jsxs)("div",{children:[Object(y.jsx)(U.a,{src:a,children:a?"":null===n||void 0===n||null===(e=n.charAt(0))||void 0===e?void 0:e.toUpperCase()}),Object(y.jsx)(d.a.Text,{className:"username",children:n})]}),Object(y.jsx)(b.a,{ghost:!0,onClick:function(){r(),p.signOut()},children:"\u0110\u0103ng xu\u1ea5t"})]})}var G,D,K,H=n(259),J=n(265),Q=H.a.Panel,Y=Object(L.a)(Q)(G||(G=Object(k.a)(["\n  &&& {\n    .ant-collapse-header,\n    p {\n      color: white;\n    }\n\n    .ant-collapse-content-box {\n      padding: 0 40px;\n    }\n\n    .add-room {\n      color: white;\n      padding: 0;\n    }\n  }\n"]))),W=Object(L.a)(d.a.Link)(D||(D=Object(k.a)(["\n  display: block;\n  margin-bottom: 5px;\n  color: white;\n"])));function X(){var e=c.a.useContext(P),t=e.rooms,n=e.setIsAddRoomVisible,a=e.setSelectedRoomId;return Object(y.jsx)(H.a,{ghost:!0,defaultActiveKey:["1"],children:Object(y.jsxs)(Y,{header:"Danh s\xe1ch c\xe1c ph\xf2ng",children:[t.map((function(e){return Object(y.jsx)(W,{onClick:function(){return a(e.id)},children:e.name},e.id)})),Object(y.jsx)(b.a,{type:"text",icon:Object(y.jsx)(J.a,{}),className:"add-room",onClick:function(){n(!0)},children:"Th\xeam ph\xf2ng"})]},"1")})}var q=L.a.div(K||(K=Object(k.a)(["\n  background: #3f0e40;\n  color: white;\n  height: 100vh;\n"])));function Z(){return Object(y.jsx)(q,{children:Object(y.jsxs)(u.a,{children:[Object(y.jsx)(j.a,{span:24,children:Object(y.jsx)(E,{})}),Object(y.jsx)(j.a,{span:24,children:Object(y.jsx)(X,{})})]})})}var $,ee,te,ne,ae,ce,re,ie=n(266),oe=n(258),se=n(64),le=n(262),de=n(264),ue=n(256),je=L.a.div($||($=Object(k.a)(["\n  margin-bottom: 10px;\n\n  .author {\n    margin-left: 5px;\n    font-weight: bold;\n  }\n\n  .date {\n    margin-left: 10px;\n    font-size: 11px;\n    color: #a7a7a7;\n  }\n\n  .content {\n    margin-left: 30px;\n  }\n"])));function be(e){var t="";return e&&(t=(t=Object(ue.a)(new Date(1e3*e),new Date)).charAt(0).toUpperCase()+t.slice(1)),t}function he(e){var t,n=e.text,a=e.displayName,c=e.createdAt,r=e.photoURL;return Object(y.jsxs)(je,{children:[Object(y.jsxs)("div",{children:[Object(y.jsx)(U.a,{size:"small",src:r,children:r?"":null===a||void 0===a||null===(t=a.charAt(0))||void 0===t?void 0:t.toUpperCase()}),Object(y.jsx)(d.a.Text,{className:"author",children:a}),Object(y.jsx)(d.a.Text,{className:"date",children:be(null===c||void 0===c?void 0:c.seconds)})]}),Object(y.jsx)("div",{children:Object(y.jsx)(d.a.Text,{className:"content",children:n})})]})}var pe=L.a.div(ee||(ee=Object(k.a)(["\n  display: flex;\n  justify-content: space-between;\n  height: 56px;\n  padding: 0 16px;\n  align-items: center;\n  border-bottom: 1px solid rgb(230, 230, 230);\n\n  .header {\n    &__info {\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n    }\n\n    &__title {\n      margin: 0;\n      font-weight: bold;\n    }\n\n    &__description {\n      font-size: 12px;\n    }\n  }\n"]))),me=L.a.div(te||(te=Object(k.a)(["\n  display: flex;\n  align-items: center;\n"]))),fe=L.a.div(ne||(ne=Object(k.a)(["\n  height: 100vh;\n"]))),Oe=L.a.div(ae||(ae=Object(k.a)(["\n  height: calc(100% - 56px);\n  display: flex;\n  flex-direction: column;\n  padding: 11px;\n  justify-content: flex-end;\n"]))),xe=Object(L.a)(oe.a)(ce||(ce=Object(k.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 2px 2px 2px 0;\n  border: 1px solid rgb(230, 230, 230);\n  border-radius: 2px;\n\n  .ant-form-item {\n    flex: 1;\n    margin-bottom: 0;\n  }\n"]))),ve=L.a.div(re||(re=Object(k.a)(["\n  max-height: 100%;\n  overflow-y: auto;\n"])));function ge(){var e=Object(a.useContext)(P),t=e.selectedRoom,n=e.members,r=e.setIsInviteMemberVisible,i=Object(a.useContext)(V).user,o=i.uid,s=i.photoURL,l=i.displayName,d=Object(a.useState)(""),u=Object(S.a)(d,2),j=u[0],h=u[1],p=oe.a.useForm(),m=Object(S.a)(p,1)[0],f=Object(a.useRef)(null),O=Object(a.useRef)(null),x=function(){v("messages",{text:j,uid:o,photoURL:s,roomId:t.id,displayName:l}),m.resetFields(["message"]),null!==f&&void 0!==f&&f.current&&setTimeout((function(){f.current.focus()}))},g=c.a.useMemo((function(){return{fieldName:"roomId",operator:"==",compareValue:t.id}}),[t.id]),C=_("messages",g);return Object(a.useEffect)((function(){null!==O&&void 0!==O&&O.current&&(O.current.scrollTop=O.current.scrollHeight+50)}),[C]),Object(y.jsx)(fe,{children:t.id?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)(pe,{children:[Object(y.jsxs)("div",{className:"header__info",children:[Object(y.jsx)("p",{className:"header__title",children:t.name}),Object(y.jsx)("span",{className:"header__description",children:t.description})]}),Object(y.jsxs)(me,{children:[Object(y.jsx)(b.a,{icon:Object(y.jsx)(ie.a,{}),type:"text",onClick:function(){return r(!0)},children:"M\u1eddi"}),Object(y.jsx)(U.a.Group,{size:"small",maxCount:2,children:n.map((function(e){var t,n;return Object(y.jsx)(se.a,{title:e.displayName,children:Object(y.jsx)(U.a,{src:e.photoURL,children:e.photoURL?"":null===(t=e.displayName)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})},e.id)}))})]})]}),Object(y.jsxs)(Oe,{children:[Object(y.jsx)(ve,{ref:O,children:C.map((function(e){return Object(y.jsx)(he,{text:e.text,photoURL:e.photoURL,displayName:e.displayName,createdAt:e.createdAt},e.id)}))}),Object(y.jsxs)(xe,{form:m,children:[Object(y.jsx)(oe.a.Item,{name:"message",children:Object(y.jsx)(le.a,{ref:f,onChange:function(e){h(e.target.value)},onPressEnter:x,placeholder:"Nh\u1eadp tin nh\u1eafn...",bordered:!1,autoComplete:"off"})}),Object(y.jsx)(b.a,{type:"primary",onClick:x,children:"G\u1eedi"})]})]})]}):Object(y.jsx)(de.a,{message:"H\xe3y ch\u1ecdn ph\xf2ng",type:"info",showIcon:!0,style:{margin:5},closable:!0})})}function ye(){return Object(y.jsx)("div",{children:Object(y.jsxs)(u.a,{children:[Object(y.jsx)(j.a,{span:6,children:Object(y.jsx)(Z,{})}),Object(y.jsx)(j.a,{span:18,children:Object(y.jsx)(ge,{})})]})})}var Ce=n(260);function we(){var e=Object(a.useContext)(P),t=e.isAddRoomVisible,n=e.setIsAddRoomVisible,c=Object(a.useContext)(V).user.uid,r=oe.a.useForm(),i=Object(S.a)(r,1)[0];return Object(y.jsx)("div",{children:Object(y.jsx)(Ce.a,{title:"T\u1ea1o ph\xf2ng",visible:t,onOk:function(){v("rooms",Object(x.a)(Object(x.a)({},i.getFieldsValue()),{},{members:[c]})),i.resetFields(),n(!1)},onCancel:function(){i.resetFields(),n(!1)},children:Object(y.jsxs)(oe.a,{form:i,layout:"vertical",children:[Object(y.jsx)(oe.a.Item,{label:"T\xean ph\xf2ng",name:"name",children:Object(y.jsx)(le.a,{placeholder:"Nh\u1eadp t\xean ph\xf2ng"})}),Object(y.jsx)(oe.a.Item,{label:"M\xf4 t\u1ea3",name:"description",children:Object(y.jsx)(le.a.TextArea,{placeholder:"Nh\u1eadp m\xf4 t\u1ea3"})})]})})})}var Ie=n(16),Ne=n(263),Re=n(152),Ae=["fetchOptions","debounceTimeout","curMembers"];function ke(e){var t=e.fetchOptions,n=e.debounceTimeout,r=void 0===n?300:n,i=e.curMembers,o=Object(Ie.a)(e,Ae),s=Object(a.useState)(!1),l=Object(S.a)(s,2),d=l[0],u=l[1],j=Object(a.useState)([]),b=Object(S.a)(j,2),h=b[0],p=b[1],m=c.a.useMemo((function(){return Object(Re.debounce)((function(e){p([]),u(!0),t(e,i).then((function(e){p(e),u(!1)}))}),r)}),[r,t,i]);return c.a.useEffect((function(){return function(){p([])}}),[]),Object(y.jsx)(Ne.a,Object(x.a)(Object(x.a)({labelInValue:!0,filterOption:!1,onSearch:m,notFoundContent:d?Object(y.jsx)(F.a,{size:"small"}):null},o),{},{children:h.map((function(e){var t,n;return Object(y.jsxs)(Ne.a.Option,{value:e.value,title:e.label,children:[Object(y.jsx)(U.a,{size:"small",src:e.photoURL,children:e.photoURL?"":null===(t=e.label)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})," ".concat(e.label)]},e.value)}))}))}function Ue(e,t){return Le.apply(this,arguments)}function Le(){return(Le=Object(o.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m.collection("users").where("keywords","array-contains",null===t||void 0===t?void 0:t.toLowerCase()).orderBy("displayName").limit(20).get().then((function(e){return e.docs.map((function(e){return{label:e.data().displayName,value:e.data().uid,photoURL:e.data().photoURL}})).filter((function(e){return!n.includes(e.value)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Se(){var e=Object(a.useContext)(P),t=e.isInviteMemberVisible,n=e.setIsInviteMemberVisible,c=e.selectedRoomId,r=e.selectedRoom,i=Object(a.useState)([]),o=Object(S.a)(i,2),s=o[0],l=o[1],d=oe.a.useForm(),u=Object(S.a)(d,1)[0];return Object(y.jsx)("div",{children:Object(y.jsx)(Ce.a,{title:"M\u1eddi th\xeam th\xe0nh vi\xean",visible:t,onOk:function(){u.resetFields(),l([]),m.collection("rooms").doc(c).update({members:[].concat(Object(O.a)(r.members),Object(O.a)(s.map((function(e){return e.value}))))}),n(!1)},onCancel:function(){u.resetFields(),l([]),n(!1)},destroyOnClose:!0,children:Object(y.jsx)(oe.a,{form:u,layout:"vertical",children:Object(y.jsx)(ke,{mode:"multiple",name:"search-user",label:"T\xean c\xe1c th\xe0nh vi\xean",value:s,placeholder:"Nh\u1eadp t\xean th\xe0nh vi\xean",fetchOptions:Ue,onChange:function(e){return l(e)},style:{width:"100%"},curMembers:r.members})})})})}var Fe=function(){return Object(y.jsx)(R.a,{children:Object(y.jsx)(T,{children:Object(y.jsxs)(z,{children:[Object(y.jsxs)(A.c,{children:[Object(y.jsx)(A.a,{component:N,path:"/login"}),Object(y.jsx)(A.a,{component:ye,path:"/"})]}),Object(y.jsx)(we,{}),Object(y.jsx)(Se,{})]})})})},Ve=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,267)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};i.a.render(Object(y.jsx)(Fe,{}),document.getElementById("root")),Ve()}},[[249,1,2]]]);
//# sourceMappingURL=main.34ac9b97.chunk.js.map